<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Manage Secretaries</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <link rel="stylesheet" href="manage-secretary.css">
</head>
<body>
  <!-- Sidebar -->
  <aside class="sidebar">
    <div class="logo">
      <h1>MyManager</h1>
    </div>
    <nav>
      <ul>
        <li><a href="dashboard.html"><i class="fas fa-tachometer-alt"></i> Dashboard</a></li>
        <li><a href="manage-patients.html"><i class="fas fa-user"></i> Manage Patients</a></li>
        <li><a href="manage-secretary.html" class="active"><i class="fas fa-user-tie"></i> Manage Secretary</a></li>
        <li><a href="reports.html"><i class="fas fa-file-alt"></i> Reports</a></li>
        <li><a href="manageappointments.html"><i class="fas fa-calendar-check"></i> Manage Appointments</a></li>
        <li><a href="../../index.html"><i class="fas fa-sign-out-alt"></i> Log Out </a></li>

      </ul>
    </nav>
  </aside>

  <!-- Main Content -->
  <main class="main-content">
    <!-- Top Bar -->
    <header class="top-bar">
      <h2>Manage Secretaries</h2>
    </header>

    <!-- Content Section -->
    <section class="content">
      <a href="add-secretary.html" class="btn-add"><i class="fas fa-user-plus"></i> Add Secretary</a>
      <table>
        <thead>
          <tr>
            <th>ID</th>
            <th>Name</th>
            <th>Role</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody id="secretaryTableBody">
          <!-- Rows will be added dynamically here -->
        </tbody>
      </table>
    </section>
  </main>

  <script>
   // Function to populate the secretary table
function populateSecretaryTable() {
  const secretaries = JSON.parse(localStorage.getItem("secretaries")) || [];
  const secretaryTableBody = document.getElementById("secretaryTableBody");

  secretaryTableBody.innerHTML = ""; // Clear existing rows

  secretaries.forEach(secretary => {
    const row = document.createElement("tr");

    row.innerHTML = `
      <td>${secretary.id}</td>
      <td>${secretary.name}</td>
      <td>${secretary.role}</td>
      <td>
        <button class="btn-edit" data-id="${secretary.id}"><i class="fas fa-edit"></i> Edit</button>
        <button class="btn-delete" data-id="${secretary.id}"><i class="fas fa-trash"></i> Delete</button>
      </td>
    `;

    secretaryTableBody.appendChild(row);
  });

  attachEventListeners(); // Attach edit/delete handlers
}


      // Retrieve secretaries from localStorage
      const secretaries = JSON.parse(localStorage.getItem("secretaries")) || [];

      // Clear existing table rows
      secretaryTableBody.innerHTML = "";

      // Populate table rows
      secretaries.forEach(secretary => {
        const row = document.createElement("tr");

        row.innerHTML = `
          <td>${secretary.id}</td>
          <td>${secretary.name}</td>
          <td>${secretary.role}</td>
          <td>
            <button class="btn-edit" data-id="${secretary.id}"><i class="fas fa-edit"></i> Edit</button>
            <button class="btn-delete" data-id="${secretary.id}"><i class="fas fa-trash"></i> Delete</button>
          </td>
        `;

        secretaryTableBody.appendChild(row);
      });

      // Attach event listeners for edit and delete
      attachEventListeners();

    // Function to handle secretary deletion
    function attachEventListeners() {
      // Delete event listeners
      document.querySelectorAll(".btn-delete").forEach(button => {
        button.addEventListener("click", function () {
          const id = this.getAttribute("data-id");

          // Retrieve and update secretaries in localStorage
          let secretaries = JSON.parse(localStorage.getItem("secretaries")) || [];
          secretaries = secretaries.filter(secretary => secretary.id != id);
          localStorage.setItem("secretaries", JSON.stringify(secretaries));

          // Refresh the table
          populateSecretaryTable();
        });
      });

      // Edit event listeners
      document.querySelectorAll(".btn-edit").forEach(button => {
        button.addEventListener("click", function () {
          const id = this.getAttribute("data-id");

          // Retrieve secretaries and find the one to edit
          const secretaries = JSON.parse(localStorage.getItem("secretaries")) || [];
          const secretary = secretaries.find(s => s.id == id);

          if (secretary) {
            // Prompt user for new values
            const newName = prompt("Edit Name:", secretary.name);
            const newRole = prompt("Edit Role:", secretary.role);

            // Update secretary data if new values are provided
            if (newName !== null) secretary.name = newName.trim();
            if (newRole !== null) secretary.role = newRole.trim();

            // Save back to localStorage
            localStorage.setItem("secretaries", JSON.stringify(secretaries));

            // Refresh the table
            populateSecretaryTable();
          }
        });
      });
    }

    // Initialize the table on page load
    document.addEventListener("DOMContentLoaded", populateSecretaryTable);
  </script>
</body>
</html>
